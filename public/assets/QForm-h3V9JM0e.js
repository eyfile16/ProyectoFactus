import{g as G,m as K,r as H,h as C,z as Q,n as V,C as I,G as N,i as j,a6 as ie,j as U,L as F,a7 as se,a8 as re,l as le,a9 as ue,q as ce,N as de,aa as fe}from"./index-ConCm_F-.js";import{h as A,v as ve,i as W,j as me,p as $,k as he,l as ge,m as ye,n as be,o as pe,q as Se,r as _,s as Te,t as Pe}from"./QTable-BUWrZeTf.js";import{u as xe,s as Ee,a as Ce,b as Oe,d as we,c as z,h as ke}from"./format-MEHmbXNd.js";const je=G({name:"QTooltip",inheritAttrs:!1,props:{...me,...Ce,...A,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{...A.transitionShow,default:"jump-down"},transitionHide:{...A.transitionHide,default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:W},self:{type:String,default:"top middle",validator:W},offset:{type:Array,default:()=>[14,14],validator:ve},scrollTarget:Ee,delay:{type:Number,default:0},hideDelay:{type:Number,default:0},persistent:Boolean},emits:[...xe],setup(e,{slots:O,emit:g,attrs:b}){let s,r;const u=K(),{proxy:{$q:l}}=u,f=H(null),m=H(!1),S=C(()=>$(e.anchor,l.lang.rtl)),y=C(()=>$(e.self,l.lang.rtl)),T=C(()=>e.persistent!==!0),{registerTick:t,removeTick:c}=he(),{registerTimeout:d}=Oe(),{transitionProps:P,transitionStyle:x}=ge(e),{localScrollTarget:w,changeScrollEvent:o,unconfigureScrollTarget:i}=ye(e,R),{anchorEl:n,canShow:E,anchorEvents:v}=be({showing:m,configureAnchorEl:oe}),{show:J,hide:k}=we({showing:m,canShow:E,handleShow:Y,handleHide:Z,hideOnRouteChange:T,processOnMount:!0});Object.assign(v,{delayShow:ee,delayHide:te});const{showPortal:D,hidePortal:B,renderPortal:X}=pe(u,f,ae,"tooltip");if(l.platform.is.mobile===!0){const a={anchorEl:n,innerRef:f,onClickOutside(h){return k(h),h.target.classList.contains("q-dialog__backdrop")&&F(h),!0}},q=C(()=>e.modelValue===null&&e.persistent!==!0&&m.value===!0);Q(q,h=>{(h===!0?Se:_)(a)}),V(()=>{_(a)})}function Y(a){D(),t(()=>{r=new MutationObserver(()=>p()),r.observe(f.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),p(),R()}),s===void 0&&(s=Q(()=>l.screen.width+"|"+l.screen.height+"|"+e.self+"|"+e.anchor+"|"+l.lang.rtl,p)),d(()=>{D(!0),g("show",a)},e.transitionDuration)}function Z(a){c(),B(),M(),d(()=>{B(!0),g("hide",a)},e.transitionDuration)}function M(){r!==void 0&&(r.disconnect(),r=void 0),s!==void 0&&(s(),s=void 0),i(),I(v,"tooltipTemp")}function p(){Te({targetEl:f.value,offset:e.offset,anchorEl:n.value,anchorOrigin:S.value,selfOrigin:y.value,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function ee(a){if(l.platform.is.mobile===!0){z(),document.body.classList.add("non-selectable");const q=n.value,h=["touchmove","touchcancel","touchend","click"].map(L=>[q,L,"delayHide","passiveCapture"]);N(v,"tooltipTemp",h)}d(()=>{J(a)},e.delay)}function te(a){l.platform.is.mobile===!0&&(I(v,"tooltipTemp"),z(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),d(()=>{k(a)},e.hideDelay)}function oe(){if(e.noParentEvent===!0||n.value===null)return;const a=l.platform.is.mobile===!0?[[n.value,"touchstart","delayShow","passive"]]:[[n.value,"mouseenter","delayShow","passive"],[n.value,"mouseleave","delayHide","passive"]];N(v,"anchor",a)}function R(){if(n.value!==null||e.scrollTarget!==void 0){w.value=ke(n.value,e.scrollTarget);const a=e.noParentEvent===!0?p:k;o(w.value,a)}}function ne(){return m.value===!0?j("div",{...b,ref:f,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",b.class],style:[b.style,x.value],role:"tooltip"},U(O.default)):null}function ae(){return j(ie,P.value,ne)}return V(M),Object.assign(u.proxy,{updatePosition:p}),X}}),Fe=G({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(e,{slots:O,emit:g}){const b=K(),s=H(null);let r=0;const u=[];function l(t){const c=typeof t=="boolean"?t:e.noErrorFocus!==!0,d=++r,P=(o,i)=>{g(`validation${o===!0?"Success":"Error"}`,i)},x=o=>{const i=o.validate();return typeof i.then=="function"?i.then(n=>({valid:n,comp:o}),n=>({valid:!1,comp:o,err:n})):Promise.resolve({valid:i,comp:o})};return(e.greedy===!0?Promise.all(u.map(x)).then(o=>o.filter(i=>i.valid!==!0)):u.reduce((o,i)=>o.then(()=>x(i).then(n=>{if(n.valid===!1)return Promise.reject(n)})),Promise.resolve()).catch(o=>[o])).then(o=>{if(o===void 0||o.length===0)return d===r&&P(!0),!0;if(d===r){const{comp:i,err:n}=o[0];if(n!==void 0&&console.error(n),P(!1,i),c===!0){const E=o.find(({comp:v})=>typeof v.focus=="function"&&ue(v.$)===!1);E!==void 0&&E.comp.focus()}}return!1})}function f(){r++,u.forEach(t=>{typeof t.resetValidation=="function"&&t.resetValidation()})}function m(t){t!==void 0&&F(t);const c=r+1;l().then(d=>{c===r&&d===!0&&(e.onSubmit!==void 0?g("submit",t):t!==void 0&&t.target!==void 0&&typeof t.target.submit=="function"&&t.target.submit())})}function S(t){t!==void 0&&F(t),g("reset"),ce(()=>{f(),e.autofocus===!0&&e.noResetFocus!==!0&&y()})}function y(){Pe(()=>{if(s.value===null)return;const t=s.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||s.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||s.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(s.value.querySelectorAll("[tabindex]"),c=>c.tabIndex!==-1);t!=null&&t.focus({preventScroll:!0})})}de(fe,{bindComponent(t){u.push(t)},unbindComponent(t){const c=u.indexOf(t);c!==-1&&u.splice(c,1)}});let T=!1;return se(()=>{T=!0}),re(()=>{T===!0&&e.autofocus===!0&&y()}),le(()=>{e.autofocus===!0&&y()}),Object.assign(b.proxy,{validate:l,resetValidation:f,submit:m,reset:S,focus:y,getValidationComponents:()=>u}),()=>j("form",{class:"q-form",ref:s,onSubmit:m,onReset:S},U(O.default))}});export{je as Q,Fe as a};
